\newcommand{\concat}{\mathbin{||}}
\newcommand{\inputs}{\mathsf{inputs}}

%fields and groups
\newcommand{\id}{\mathsf{id}}
\newcommand{\overflow}{\mathsf{overflow}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\Fp}{\F_p}
\newcommand{\Fq}{\F_q}
\newcommand{\Ftwo}{\F_2}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\T}{\mathbb{T}}
\newcommand{\Qbar}{\overline{\Q}}
\newcommand{\G}{\mathbb{G}}
\newcommand{\Vs}{\mathbb{V}}
\newcommand{\Fbar}{\overline{\mathbb{F}}}
\newcommand{\Hash}{\mathsf{Hash}}
\newcommand{\Omtilde}{\widetilde{\Omega}}

\newcommand{\Enc}{\mathsf{Enc}}
\newcommand{\Dec}{\mathsf{Dec}}
\renewcommand{\DH}{\mathsf{DH}}
\newcommand{\gen}{\mathsf{Gen}}
\newcommand{\enc}{\Enc}
\newcommand{\dec}{\Dec}

\DeclareMathOperator*{\E}{\textrm{E}}

\DeclareMathOperator*{\Dima}{\textrm{Dima}}


%vectors, etc.
\newcommand{\av}{\mathbf{a}} \newcommand{\cv}{\mathbf{c}}
\newcommand{\dv}{\mathbf{d}} \newcommand{\ev}{\mathbf{e}}
\newcommand{\rv}{\mathbf{r}} \newcommand{\sv}{\mathbf{s}}
\newcommand{\tv}{\mathbf{t}} \newcommand{\uv}{\mathbf{u}}
%\newcommand{\vv}{\mathbf{v}} \newcommand{\wv}{\mathbf{w}}
\newcommand{\xv}{\mathbf{x}} \newcommand{\yv}{\mathbf{y}}
\newcommand{\zv}{\mathbf{z}} \newcommand{\zerov}{\mathbf{0}}
\renewcommand{\AA}{\mathbf{A}} \newcommand{\BB}{\mathbf{B}}
\newcommand{\CC}{\mathbf{C}} \newcommand{\FF}{\mathbf{F}}
\newcommand{\MM}{\mathbf{M}} \newcommand{\RR}{\mathbf{R}}
\renewcommand{\SS}{\mathbf{S}} \newcommand{\TT}{\mathbf{T}}
\newcommand{\UU}{\mathbf{U}} \newcommand{\XX}{\mathbf{X}}
\newcommand{\YY}{\mathbf{Y}} \newcommand{\KK}{\mathbf{K}}
\newcommand{\A}{\mathcal{A}} \newcommand{\B}{\mathcal{B}}
\newcommand{\dash}{\mbox{---}}
\renewcommand{\O}{\mathcal{O}}
\newcommand{\qq}{\mathfrak{q}}
\newcommand{\QQ}{\mathfrak{Q}}
\newcommand{\ZQ}{\Z_{q}}

\newcommand{\vu}{\mathbf{u}}

\newcommand{\todo}[1]{{\color{red}[\textbf{TODO}: #1]}}
\newcommand{\arvid}[1]{{\color{blue}[\textbf{Arvid}: #1]}}
\newcommand{\stzh}[1]{{\color{green}[\textbf{stzh}: #1]}}
\newcommand{\sualeh}[1]{{\color{purple}[\textbf{Sualeh}: #1]}}


\newcommand{\mr}[1]{\ensuremath{\mathrm{{#1}}}}
\newcommand{\la}{\ensuremath{\leftarrow}}
\newcommand{\ra}{\ensuremath{\rightarrow}}
\newcommand{\ala}{\ensuremath{\ \la\ }}
\newcommand{\ara}{\ensuremath{\ \ra\ }}
\newcommand{\rf}{\ensuremath{\overset{\$}{\la}}}

\newcommand{\calA}{\ensuremath{\mathcal{A}}}
\newcommand{\calB}{\ensuremath{\mathcal{B}}}
\newcommand{\calC}{\ensuremath{\mathcal{C}}}
\newcommand{\calD}{\ensuremath{\mathcal{D}}}
\newcommand{\calE}{\ensuremath{\mathcal{E}}}
\newcommand{\calF}{\ensuremath{\mathcal{F}}}
\newcommand{\calG}{\ensuremath{\mathcal{G}}}
\newcommand{\calH}{\ensuremath{\mathcal{H}}}
\newcommand{\calI}{\ensuremath{\mathcal{I}}}
\newcommand{\calJ}{\ensuremath{\mathcal{J}}}
\newcommand{\calK}{\ensuremath{\mathcal{K}}}
\newcommand{\calL}{\ensuremath{\mathcal{L}}}
\newcommand{\calM}{\ensuremath{\mathcal{M}}}
\newcommand{\calN}{\ensuremath{\mathcal{N}}}
\newcommand{\calO}{\ensuremath{\mathcal{O}}}
\newcommand{\calP}{\ensuremath{\mathcal{P}}}
\newcommand{\calQ}{\ensuremath{\mathcal{Q}}}
\newcommand{\calR}{\ensuremath{\mathcal{R}}}
\newcommand{\calS}{\ensuremath{\mathcal{S}}}
\newcommand{\calT}{\ensuremath{\mathcal{T}}}
\newcommand{\calU}{\ensuremath{\mathcal{U}}}
\newcommand{\calV}{\ensuremath{\mathcal{V}}}
\newcommand{\calW}{\ensuremath{\mathcal{W}}}
\newcommand{\calX}{\ensuremath{\mathcal{X}}}
\newcommand{\calY}{\ensuremath{\mathcal{Y}}}
\newcommand{\calZ}{\ensuremath{\mathcal{Z}}}

% -- bold math symbols, for some reason --
\newcommand{\boldalpha}{\ensuremath{\boldsymbol{\alpha}}}
\newcommand{\boldchi}{\ensuremath{\boldsymbol{\chi}}}
\newcommand{\boldtau}{\ensuremath{{\boldsymbol{\tau}}}}
\newcommand{\boldstar}{\ensuremath{\mathbf{*}}}
\newcommand{\bolda}{\ensuremath{\mathbf{a}}}
\newcommand{\boldb}{\ensuremath{\mathbf{b}}}
\newcommand{\boldc}{\ensuremath{\mathbf{c}}}
\newcommand{\boldd}{\ensuremath{\mathbf{d}}}
\newcommand{\bolde}{\ensuremath{\mathbf{e}}}
\newcommand{\boldf}{\ensuremath{\mathbf{f}}}
\newcommand{\boldg}{\ensuremath{\mathbf{g}}}
\newcommand{\boldh}{\ensuremath{\mathbf{h}}}
\newcommand{\boldi}{\ensuremath{\mathbf{i}}}
\newcommand{\boldj}{\ensuremath{\mathbf{j}}}
\newcommand{\boldk}{\ensuremath{\mathbf{k}}}
\newcommand{\boldl}{\ensuremath{\mathbf{l}}}
\newcommand{\boldm}{\ensuremath{\mathbf{m}}}
\newcommand{\boldn}{\ensuremath{\mathbf{n}}}
\newcommand{\boldo}{\ensuremath{\mathbf{o}}}
\newcommand{\boldp}{\ensuremath{\mathbf{p}}}
\newcommand{\boldq}{\ensuremath{\mathbf{q}}}
\newcommand{\boldr}{\ensuremath{\mathbf{r}}}
\newcommand{\bolds}{\ensuremath{\mathbf{s}}}
\newcommand{\boldt}{\ensuremath{\mathbf{t}}}
\newcommand{\boldu}{\ensuremath{\mathbf{u}}}
\newcommand{\boldv}{\ensuremath{\mathbf{v}}}
\newcommand{\boldw}{\ensuremath{\mathbf{w}}}
\newcommand{\boldx}{{\ensuremath{\mathbf{x}}}}
\newcommand{\boldy}{\ensuremath{\mathbf{y}}}
\newcommand{\boldz}{\ensuremath{\mathbf{z}}}
\newcommand{\boldzero}{\ensuremath{\boldsymbol{0}}}
\newcommand{\boldone}{\ensuremath{\boldsymbol{1}}}
\newcommand{\boldpi}{\ensuremath{\boldsymbol{\pi}}}
\newcommand{\boldPi}{\ensuremath{\boldsymbol{\Pi}}}

% -- bold italic math symbols, for some reason --
\newcommand{\boldia}{\ensuremath{\boldsymbol{a}}}
\newcommand{\boldib}{\ensuremath{\boldsymbol{b}}}
\newcommand{\boldic}{\ensuremath{\boldsymbol{c}}}
\newcommand{\boldid}{\ensuremath{\boldsymbol{d}}}
\newcommand{\boldie}{\ensuremath{\boldsymbol{e}}}
\newcommand{\boldif}{\ensuremath{\boldsymbol{f}}}
\newcommand{\boldig}{\ensuremath{\boldsymbol{g}}}
\newcommand{\boldih}{\ensuremath{\boldsymbol{h}}}
\newcommand{\boldii}{\ensuremath{\boldsymbol{i}}}
\newcommand{\boldij}{\ensuremath{\boldsymbol{j}}}
\newcommand{\boldik}{\ensuremath{\boldsymbol{k}}}
\newcommand{\boldil}{\ensuremath{\boldsymbol{l}}}
\newcommand{\boldim}{\ensuremath{\boldsymbol{m}}}
\newcommand{\boldin}{\ensuremath{\boldsymbol{n}}}
\newcommand{\boldio}{\ensuremath{\boldsymbol{o}}}
\newcommand{\boldip}{\ensuremath{\boldsymbol{p}}}
\newcommand{\boldiq}{\ensuremath{\boldsymbol{q}}}
\newcommand{\boldir}{\ensuremath{\boldsymbol{r}}}
\newcommand{\boldis}{\ensuremath{\boldsymbol{s}}}
\newcommand{\boldit}{\ensuremath{\boldsymbol{t}}}
\newcommand{\boldiu}{\ensuremath{\boldsymbol{u}}}
\newcommand{\boldiv}{\ensuremath{\boldsymbol{v}}}
\newcommand{\boldiw}{\ensuremath{\boldsymbol{w}}}
\newcommand{\boldix}{\ensuremath{\boldsymbol{x}}}
\newcommand{\boldiy}{\ensuremath{\boldsymbol{y}}}
\newcommand{\boldiz}{\ensuremath{\boldsymbol{z}}}

\newcommand{\transpose}[1]{\ensuremath{{#1}^{\intercal}}}

\newcommand{\boldA}{\ensuremath{\mathbf{A}}}
\newcommand{\boldB}{\ensuremath{\mathbf{B}}}
\newcommand{\boldC}{\ensuremath{\mathbf{C}}}
\newcommand{\boldD}{\ensuremath{\mathbf{D}}}
\newcommand{\boldE}{\ensuremath{\mathbf{E}}}
\newcommand{\boldF}{\ensuremath{\mathbf{F}}}
\newcommand{\boldG}{\ensuremath{\mathbf{G}}}
\newcommand{\boldH}{\ensuremath{\mathbf{H}}}
\newcommand{\boldI}{\ensuremath{\mathbf{I}}}
\newcommand{\boldJ}{\ensuremath{\mathbf{J}}}
\newcommand{\boldK}{\ensuremath{\mathbf{K}}}
\newcommand{\boldL}{\ensuremath{\mathbf{L}}}
\newcommand{\boldM}{\ensuremath{\mathbf{M}}}
\newcommand{\boldN}{\ensuremath{\mathbf{N}}}
\newcommand{\boldO}{\ensuremath{\mathbf{O}}}
\newcommand{\boldP}{\ensuremath{\mathbf{P}}}
\newcommand{\boldQ}{\ensuremath{\mathbf{Q}}}
\newcommand{\boldR}{\ensuremath{\mathbf{R}}}
\newcommand{\boldS}{\ensuremath{\mathbf{S}}}
\newcommand{\boldT}{\ensuremath{\mathbf{T}}}
\newcommand{\boldU}{\ensuremath{\mathbf{U}}}
\newcommand{\boldV}{\ensuremath{\mathbf{V}}}
\newcommand{\boldW}{\ensuremath{\mathbf{W}}}
\newcommand{\boldX}{\ensuremath{\mathbf{X}}}
\newcommand{\boldY}{\ensuremath{\mathbf{Y}}}
\newcommand{\boldZ}{\ensuremath{\mathbf{Z}}}

\newcommand{\defeq}{\overset{\text{\tiny def}}{=}}
\newcommand{\deq}{\defeq}
\newcommand{\zo}{\ensuremath{\{0,1\}}} % bits
\newcommand{\zon}{\ensuremath{\{0,1\}^n}} % bits

% Theorem definitions

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem*{rtheorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{remark}
\newtheorem*{remark}{Remark}
\theoremstyle{definition}
\newtheorem*{claims}{Claim}
\newtheorem*{theorems}{Theorem}
\newtheorem{defn}[theorem]{Definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{fact}[theorem]{Fact}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{const}[theorem]{Construction}
\newtheorem{attackgame}[theorem]{Attack Game}


\newtheoremstyle{goal}% name of the style to be used
  {\topsep}% measure of space to leave above the theorem. E.g.: 3pt
  {\topsep}% measure of space to leave below the theorem. E.g.: 3pt
  {\normalfont}% name of font to use in the body of the theorem
  {0pt}% measure of space to indent
  {\bfseries}% name of head font
  {: } %punctuation between head and body
  { }% space after theorem head; " " = normal interword space
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}
\theoremstyle{goal}
\newtheorem{sgoal}{Security Goal}
\newtheorem{fgoal}{Functionality Goal}

%% custom macros

\newcommand{\Perms}{\operatorname{perms}}
\newcommand{\esm}[1]{\ensuremath{#1}}
\newcommand{\ms}[1]{\esm{\mathsf{#1}}}

\newcommand{\compind}{\appc}
\newcommand{\prg}{\ms{PRG}}
\newcommand{\prf}{\ms{PRF}}
\newcommand{\prp}{\ms{PRP}}

\newcommand{\poly}{\operatorname{poly}}
\newcommand{\polylog}{\operatorname{polylog}}
\newcommand{\negl}{\operatorname{negl}}

\newcommand{\hyb}{\ms{Hyb}}
\newcommand{\Funs}{\ms{Funs}}
\newcommand{\getsr}{\rgets}
\newcommand{\rgets}{\mathrel{\mathpalette\rgetscmd\relax}}
\newcommand{\rgetscmd}{\ooalign{$\leftarrow$\cr
    \hidewidth\raisebox{1.2\height}{\scalebox{0.5}{\ \rm R}}\hidewidth\cr}}

%\getsr with proper vertical space.    
% this makes it typeset better in subscripts
\def\getsrx{\mathrel{%
    \mathchoice{\GETSRX}{\GETSRX}{\scriptsize\GETSRX}{\tiny\GETSRX}%
}}
\def\GETSRX{{%
\setbox0\hbox{$\gets$}%
\rlap{\hbox to \wd0{\hss$\raisebox{1.2\height}{\scalebox{0.5}{\ R}}$\hss}}\box0
}}

\newcommand{\Unif}{\ms{Unif}}

\newcommand{\iseq}{\stackrel{?}{=}}

\newcommand{\appc}{\stackrel{c}{\approx}}
\newcommand{\apps}{\stackrel{s}{\approx}}
\newcommand{\abs}[1]{\left| #1 \right|}

\newcommand{\classP}{\ms{P}}
\newcommand{\classBPP}{\ms{BPP}}
\newcommand{\classNP}{\ms{NP}}
\newcommand{\Ppoly}{\ms{P}/\ms{poly}}
\newcommand{\NCone}{\ms{NC^1}}

\newcommand{\round}[1]{\left\lfloor #1 \right\rceil}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\ceil}[1]{\left\lceil #1 \right\rceil}
\newcommand{\iprod}[1]{\left\langle #1 \right\rangle}
\newcommand{\norm}[1]{\left\| #1 \right\|}
\newcommand{\set}[1]{\left\{ #1 \right\}}

\newcommand{\Zp}{\Z_p}
\newcommand{\Zq}{\Z_q}

\newcommand{\subind}[2]{{#1}^{(#2)}}

\newcommand{\eqq}{\stackrel{?}{=}}

\newcommand{\Otilde}{\widetilde{O}}
\newcommand{\Otildel}{\widetilde{O}_\lambda}
\newcommand{\Omtildel}{\widetilde{\Omega}_\lambda}

\newcommand{\hc}{\ms{hc}}

\newcommand{\xstar}{x^*}
\newcommand{\ystar}{y^*}

\newcommand{\DDHAdv}{\ms{DDHAdv}}
\newcommand{\PRFAdv}{\ms{PRFAdv}}
\newcommand{\PRGAdv}{\ms{PRGAdv}}

\newcommand{\ct}{\ms{ct}}

\newcommand{\View}{\ms{View}}
\newcommand{\view}{\View}
%\newcommand{\view}{\ms{View}_{\calV^*}}

\newcommand{\bv}{\mathbf{b}}
\newcommand{\Bm}{\mathbf{B}}
\newcommand{\Rm}{\mathbf{R}}
\newcommand{\Gm}{\mathbf{G}}

\newcommand{\pro}[1]{\langle #1 \rangle}
\newcommand{\Comm}{\ms{Commit}}
\newcommand{\cSAT}{\ms{circuit}\text{-}\ms{SAT}}

\newcommand{\op}{\ms{op}}
\newcommand{\ck}{\ms{ck}}
\newcommand{\st}{\ms{st}}

\newcommand{\sk}{{\ms{sk}}}
\newcommand{\pk}{\ms{pk}}

\newcommand{\ol}{1^{\lambda}}
\newcommand*{\Zpos}{\Zgz}


%%%%
% Custom stuff
\newcommand{\Route}{\mathsf{Route}}
\newcommand*{\algcomment}[1]{\texttt{\null\hfill\small {\color{gray} // #1}}}
\newcommand{\keyspace}{\calK}
\newcommand{\msgspace}{\calM}
\newcommand{\ctspace}{\calC}
\newcommand{\prfkey}{k}
\newcommand{\xor}{\oplus}
% crypto and math commands 
\newcommand{\diam}{\operatorname{diam}}

\newcommand{\setup}{\mathsf{Setup}}
\newcommand{\rte}{\mathsf{Route}}
\newcommand{\dist}{\mathsf{Distribute}}

\newcommand{\decode}{\mathsf{PIR.Decode}}
\newcommand{\queries}{\mathsf{queries}}
\newcommand{\slot}{\mathsf{slot}}
\newcommand{\slots}{\mathsf{slots}}
\newcommand{\keys}{\mathsf{keys}}
\newcommand{\pred}{\mathsf{pred}}
\newcommand{\data}{\mathsf{data}}
\newcommand{\db}{\mathsf{db}}
\newcommand{\predIndex}{\mathsf{predIndex}}
\newcommand{\indexOf}{\mathsf{indexOf}}
\newcommand{\predSlot}{\mathsf{predSlot}}
%\renewcommand{\Cap}{\mathsf{cap}}
\newcommand{\rows}{\mathsf{rows}}
\newcommand{\SetupHelp}{\mathsf{SetupHelp}}
\newcommand{\Dreal}{\calD_\text{real}}
\newcommand{\Dideal}{\calD_\text{ideal}}
\newcommand{\Cpp}{C\nolinebreak\hspace{-.05em}\raisebox{.1ex}{+}\nolinebreak\hspace{-.10em}\raisebox{.1ex}{+}\xspace}

\newcommand{\pdtuple}{(\setup,\allowbreak \dist, \allowbreak \dec)}

% Counters
\newcounter{protocol-number}
\newcommand{\protocolNumber}{\refstepcounter{protocol-number}\arabic{protocol-number}}


% crypto and math commands 

\newcommand{\MAC}{\text{MAC}}
\newcommand{\Com}{\text{Com}}
\newcommand{\Verify}{\text{Verify}}
\newcommand{\TU}{\mathsf{TU}}
\newcommand{\msg}{\mathsf{msg}}
\newcommand{\reg}{\mathsf{reg}}
\newcommand{\req}{\mathsf{req}}
\newcommand{\resp}{\mathsf{resp}}
\newcommand{\query}{\mathsf{Query}}
\newcommand{\answer}{\mathsf{Answer}}
\newcommand{\cK}{\mathcal{K}}
\newcommand{\Sim}{\mathsf{Sim}}
\newcommand{\cA}{\mathcal{A}}
\newcommand{\cI}{\mathcal{I}}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\sym}{\text{sym}}
\newcommand{\pir}{\text{pir}}
\newcommand{\asphr}{\text{asphr}}

\newcommand{\trust}{\mathsf{TrustEst}}
\newcommand{\send}{\mathsf{Send}}

\newcommand{\DB}{\mathsf{DB}}

% asphr main method
\newcommand{\Register}{\mathsf{Register}}
\newcommand{\Userinput}{\mathsf{Input}}
\newcommand{\Initserver}{\mathsf{Initserver}}
\newcommand{\Clientrpc}{\mathsf{ClientRPC}}
\newcommand{\Serverrpc}{\mathsf{ServerRPC}}